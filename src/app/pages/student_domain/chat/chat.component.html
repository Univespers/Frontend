<div class="container">
  <!-- Lista de conversas -->
  <div class="chat-list mat-elevation-z5">
    <div class="search-input">
      <mat-form-field>
        <input
          matInput
          placeholder="Procurar usuário"
          [formControl]="searchControl"
          [matAutocomplete]="users"
        />
      </mat-form-field>

      <mat-autocomplete #users="matAutocomplete">
        <mat-option *ngFor="let user of filteredUsers$ | async" [value]="user.nome">
          {{ user.nome }}
        </mat-option>
      </mat-autocomplete>
    </div>

    <h3>Conversas</h3>
    <div
      *ngFor="let conv of conversations$ | async"
      (click)="openConversation(conv)"
      class="conversation-item"
    >
      <p>
        <b>{{ conv.members[0].nome }}</b> e <b>{{ conv.members[1].nome }}</b>
      </p>
      <small *ngIf="conv.messages.length > 0">
        Última: {{ conv.messages[conv.messages.length - 1].text }}
      </small>
    </div>
  </div>

  <!-- Área de mensagens -->
  <div class="messages mat-elevation-z5">
    <div *ngFor="let msg of messages$ | async" class="message">
      <strong>{{ getSenderName(msg.senderId) }}:</strong>
      <span>{{ msg.text }}</span>
    </div>

    <div *ngIf="selectedConversation" class="message-input">
      <input #newMsg placeholder="Digite sua mensagem..." />
      <button (click)="sendMessage(newMsg.value); newMsg.value=''">Enviar</button>
    </div>
  </div>
</div>
